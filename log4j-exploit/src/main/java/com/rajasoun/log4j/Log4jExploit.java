package com.rajasoun.log4j;

import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.LogManager;

import javax.naming.InitialContext;

import static spark.Spark.*;

public class Log4jExploit {
    static final Logger logger = LogManager.getLogger(Log4jExploit.class.getName());

    public static void main(String[] args) {
        //System.setProperty("com.sun.jndi.ldap.object.trustURLCodebase","true");
        port(8080);
        get("/*", (req, res) -> {
            String ua = req.headers("User-Agent");
            System.out.println("logging ua: " + ua);
            // trigger on error
            logger.error("Code Injection: " + ua);
            return "ok: ua: " + ua + " ";
        });
    }
}
