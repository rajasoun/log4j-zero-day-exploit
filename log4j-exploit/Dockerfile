FROM maven AS build
ADD . /log4j-exploit
WORKDIR /log4j-exploit
RUN mvn clean compile assembly:single

FROM gcr.io/distroless/java:11
COPY --from=build /log4j-exploit/target/log4j-exploit-1.0-SNAPSHOT-jar-with-dependencies.jar /log4j-exploit.jar

EXPOSE 8080

ENTRYPOINT ["java", "-Dcom.sun.jndi.ldap.object.trustURLCodebase=true", "-jar", "/log4j-exploit.jar"]
